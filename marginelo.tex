\documentclass[aps,prc,reprint,amsmath,superscriptaddress]{revtex4-1}

\usepackage{color}
\definecolor{theblue}{RGB}{0,50,230}

\usepackage{hyperref}
\hypersetup{
  colorlinks=true,
  linkcolor=theblue,
  citecolor=theblue,
  urlcolor=theblue
}

\usepackage{graphicx}
\graphicspath{{fig/}}

\newcommand{\R}{\mathcal{R}}
\newcommand{\psec}[1]{\phantomsection\addcontentsline{toc}{section}{#1}}

\begin{document}

\title{Predicting outcomes in games of skill by redefining what it means to win}

\author{J.\ Scott Moreland}
\affiliation{Department of Physics, Duke University, Durham, NC 27708-0305}
\author{Matthew C.\ Superdock}
\affiliation{Department of Computer Science, Carnegie Mellon University, Pittsburgh, PA 15213}

\date{\today}


\begin{abstract}
The Elo rating system is a highly successful ranking algorithm for games of skill where, by construction, one team wins and the other loses.
A primary limitation of present implementations of the Elo algorithm is the ability to predict information beyond a match's win-loss probability.
For example, in the traditional Elo system the victor is awarded the same point bounty if he beats a team by 1 point or 10 points; only the rating difference between the team and its opponent affects the match bounty.
Previous efforts to extend the Elo system to incorporate margin-of-victory information have relied on adhoc assumptions which do not converge on the true margin dependent win probability in the relevant limits.
In this work, we explain that Elo ratings and predictions can be naturally extended to include margin-of-victory information by simply redefining ``what it means to win''.
We create ratings for each value of the margin-of-victory and use these ratings to predict the \emph{full} distribution of point spread outcomes for matches which have not yet been played.
\end{abstract}


\maketitle

\section{Elo rating system}

The Elo system ascribes a power ranking index $\R$ to each competitor (player or team) which can be used to predict the outcome of a future matchup.
Teams with a higher rating are viewed as more likely to win their matchup, and teams with a lower rating are more likely to lose.
The process is fundamentally Bayesian and rating values before and after the match reflect prior and posterior knowledge of each team's performance.

The convention is to initialize all team ratings at ${\R_0 = 1500}$, although this choice is arbitrary.
As we show momentarily, only the rating difference between two teams matters, and hence the Elo rating can be initialized with any starting value.
The ratings of the competitors are then updated iteratively after each matchup.
Teams gain or lose points based on the outcome of the match and the rating difference between the two competitors.
One is awarded more points for beating a stronger opponent and less points for beating a weaker opponent.
The points awarded to the victor are deducted from the loser such that the total number of points in the system is always conserved.

More specifically, the victor bounty scales with the degree to which a team exceeds (or falls short of) their expected match performance.
Let $P_\text{exp}$ denote the expected probability that a team beats their opponent at a neutral venue.
The bounties that the team and their opponent receive from the outcome of the match are given by,
\begin{align}
  \label{elo}
  \Delta \R_\text{team} &= \kappa \,(P_\text{obs} - P_\text{exp}),\\
  \Delta \R_\text{opp} &= -\Delta \R_\text{team},
\end{align}
where ${P_\text{obs}=1}$ if the team beats their opponent and ${P_\text{obs}=0}$ if the team loses, while $P_\text{obs}=0.5$ is often used if both teams tie.
The free parameter $\kappa$ modulates the relative weight of prior and posterior information. 
If $\kappa$ is small, the prior holds significant weight, and it takes many successive wins or losses to move the rating up or down.
Conversely, when $\kappa$ is large, each win or loss can significantly affect the team's rating.
Typically, the hyper-parameter $\kappa$ is tuned to optimize the veracity of model predictions by back-testing on historical games.

The expected probability $P_\text{exp}$ that a team beats their opponent is modeled using a logistic function
\begin{equation}
  \label{win_prob}
  P_\text{exp}(\R_\text{team}, \R_\text{opp}) = \frac{1}{10^{-(\R_\text{team} - \R_\text{opp})/\gamma} +1},
\end{equation}
where the free parameter $\gamma$ sets the scale of rating differences.
Much like the starting Elo, the parameter $\gamma$ can take any value and only the ratio $\kappa/\gamma$ is meaningful for observable quantities.
A common convention is to fix $\gamma=400$ such that a 400 point rating advantage corresponds to a 90\% average win rate.

A primary feature of the Elo system is that the expected win probability $P_\text{exp}$ determined from iteratively updated Elo ratings $\R_\text{team}$ and $\R_\text{opp}$, converges on the \emph{true} win probability of the matchup when the competitors sample scores from independent random variables.
In the limit of infinitely many games and infinitely small update factor $\kappa$, the Elo calculated win probability \emph{is} the true win probability.

We demonstrate this convergence property of the Elo algorithm by simulating a series of games between two different teams using a simple a toy model.
The teams are represented by a Poisson distribution with two different means, one with mean $\mu=16$ and the other with mean $\mu=10$.
We sampled a pair of scores for each game, determine a winner, and update each team's Elo ratings accordingly.
Figure~\ref{fig:win_rate} compares the spread distribution's true win rate (black line), to the win rate calculated from Eqn.~\eqref{win_prob} (blue line).
The two quantities agree within statistical fluctuations, as the Elo ratings naturally trend toward equilibrium.
For instance, if one Elo rating becomes artificially inflated by a series of statistically anomalous wins, it is heavily penalized by any subsequent losses and trends back toward its equilibrium value.
\begin{figure}
  \includegraphics{win_rate}
  \caption{\label{fig:win_rate} Time series win rate for a toy model with different handicaps (listed on the right) applied to the stronger team. The black horizontal dashed lines are the true win rate of the sampled distribution under the imposed handicap and the blue solid line is the reconstructed (predicted) win rate determined by updating handicapped and advantaged Elo ratings for each team and applying Eqn.~\eqref{win_prob_hcap}. This particular toy model is a distribution of scores sampled from the difference of two Poisson random variables. The stronger team has a mean score of $16$ and the weaker team a mean of $10$. Notice that the win rate is $\sim\!50\%$ when the handicap equals $6$ points. Actually, to be exact it is slightly below 50\% as the chosen win criteria requires that a team win by \emph{more} than 0.}
\end{figure}

\section{Margin-of-victory Elo}

The original Elo model was first applied to chess rankings where there is a winner and a loser but no score.
It can be used to predict the odds with which a player beats his opponent \eqref{win_prob}, and correspondingly---by calculating various outcomes---the odds with which a player advances through a tournament. 

The model is easily extended to point based games by ignoring the margin-of-victory and only considering wins and losses.
One shortcoming of this approach is that it cannot predict the mean or median point spreads which are often used to set betting lines and which are interesting in their own right.
Methods have been proposed to retain margin-of-victory information by allowing the parameter $\kappa$ in Eq.~\eqref{elo} to vary with the point spread.
The idea is that if a team finds itself in a rating slump, subsequent dominant victories should raise the team's rating faster than successive close wins.
The method appeared in football Elo ratings \cite{?} and was adapted to forecast NFL and NBA team performance on the analytics and news platform FiveThirtyEight \footnote{for an extensive list of Elo use cases see \ref{?}}.

Spread-dependent $\kappa$-factors possess some desirable features, but they also introduce a number of problems.
There is no obvious form for a margin-of-victory multiplier on $\kappa$, and introducing one still does not get one any closer to predicting the mean or median score of a game.
There are also issues of autocorrelation, i.e.\ great teams should not be over rewarded for winning by large margins because that's what great teams do.

\begin{figure}[b]
  \includegraphics{example_distribution}
  \label{fig:example}
  \caption{Example cumulative probability distribution function (CDF) of point spreads calculated for a specific matchup from the margin-dependent Elo model. Note that the function is not strictly monotonic due to fluctuations in the decoupled Elo ratings at each value of the spread.}
\end{figure}

There is, alternatively, a more natural extension of Elo ratings which allows one to incorporate margin-of-victory information and predict the mean and median score of future games.
We start by emphasizing that Elo ratings only require actors which compete to win games and that ``winning'' is a subjective definition itself.
Let $p_s$ and $p_a$ denote points scored and points allowed by a team of interest respectively.
The usual win criteria is defined as
\begin{equation}
  \text{win}: p_s - p_a > 0.
\end{equation}
This is the fair or democratic criteria as it gives each competitor a level playing field.
Just as easily, one could define winning as
\begin{equation}
  \text{win}: p_s - p_a > n,
\end{equation}
where $n$ is a finite margin-of-victory line.
This is equivalent to a normal Elo rating system where a point handicap is applied in favor of one team.

To calculate the probability that a team beats an opponent by more than $n$ points, one need only calculate the Elo ratings of the team and their opponent under an $n$-point team handicap, i.e.\ according to the win criteria
\begin{equation}
  \text{win}: p_s - p_a - n > 0.
\end{equation}
The handicapping procedure splits team ratings into two different groups: a rating handicapped by $n$ points, and a rating advantaged by $n$ points.

To get a better feel for what this does, imagine an average team under the classical Elo system which corresponds to a handicap $n=0$. 
As we apply a handicap $n$ to the home team, it becomes increasingly difficult for the team to overcome their handicap and win games.
The team's handicapped Elo rating will drop, and eventually will fall below even the worst non-handicapped team.
Simultaneously, we must also keep track of each team's performance \emph{against} handicapped teams, i.e.\ for $n \rightarrow -n$.
Naturally, this will have an opposite effect, and each team's advantaged rating will rise as their handicap goes more negative.

The procedure thus creates mirror copies of each team's rating at each value of the spread: the handicapped rating $\R_\text{team}(n)$, and advantaged rating $\R_\text{team}(-n)$.
To predict the probability that a team will beat their opponent by more than $n$ points, we apply Eqn.~\eqref{win_prob} to their handicapped and advantaged Elo ratings
\begin{equation}
  \label{win_prob_hcap}
  P_\text{exp}(\R_\text{team}, \R_\text{opp}; n) = \frac{1}{10^{-(\R_\text{team}(n) - \R_\text{opp}(-n))/\gamma} + 1}.
\end{equation}

The procedure can easily be applied for each integer value of $n$ up to some large number in order to calculate the margin-dependent Elo ratings for every reasonable margin-of-victory.
Once done, the resulting ratings can be used to predict the probability that a team beats its opponent by any point number.
The procedure simply constructs the point spread cumulative distribution function (CDF) for the team of interest
\begin{equation}
  \label{cdf}
  F(n) = \sum_{s=n}^\infty P(s),
\end{equation}
where $s = p_s - p_a$.
This is the full probability distribution of allowable point spreads and can be used to calculate both the mean and median point values.

We show, as an example, in Fig.~\ref{fig:example} the resulting probability distribution calculated from Eqn.~\eqref{win_prob_hcap} for an NFL game in which the Cleveland Browns host the Pittsburgh Steelers. 
Note that the sign convention used here is opposite what is typically used in Vegas.
Negative spreads in Fig~\ref{fig:example} mean Cleveland is an underdog while positive spreads mean they are favored.
The distribution median, indicated by a vertical orange line, shows that the Browns are significant 7 point underdogs at home.

\section{Descriptive Statistics}

A primary advantage of margin-dependent Elo ratings is that they predict the full probability distribution of expected outcomes.
This allows one to calculate various statistical properties of the distribution such as its mean, median and standard deviation.
It also allows one to calculate the probability that the observed point spread falls above or below arbitrary values as well as within specific intervals---probabilistic outcomes which are commonly used in betting circles.

\subsection{Median point spread}

The median point spread is the value which gives both teams equal odds to cover.
It's a popular betting statistic as it generally promotes equal numbers of bets on both sides of the line which increases betting volume and minimizes risk for the house.
In the margin-dependent Elo model, we can easily estimate the median point spread by calculating the handicapped and advantaged ratings at each value of the spread, and by finding the spread where the win probability between the handicapped and advantaged teams is closest to 50\%.
This is equivalent to the point spread $\tilde{s}$ such that
\begin{equation}
  \R_\text{team}(n) \approx \R_\text{opp}(-n).
\end{equation}

One should be reasonably concerned that the handicapped Elo ratings will be unreliable for large values of the spread as the handicapped team will seldom win.
Indeed, there are large uncertainties in predicting a blowout as the statistics are simply insufficient to extrapolate from prior to future events.
In contrast to these extreme spread values, the spread median is---by definition---the value where wins and losses occur with equal probability and hence events are maximally frequent to maintain rating equilibrium.
One should expect the median values to be relatively accurate within the limitations of the model.

\subsection{Mean point spread}

Although the mean point spread is less commonly used in betting circles, it's nevertheless interesting to compute.
The mean point spread can be obtained from the cumulative point spread distribution $F$ via integration by parts
\begin{equation}
  \label{parts}
  \bar{s} = \sum\limits_{s_\text{min}}^{s_\text{max}} s P(s) = s_\text{max} - \sum\limits_{s_\text{min}}^{s_\text{max}} F(s),
\end{equation}
where the boundary term in Eqn.~\ref{parts} simplifies since the CDF converges to $F(s_\text{max})=0$ and $F(s_\text{min})=1$ at the point spread extrema.

The mean and median are, in general, equal only for symmetric distributions and may differ significantly in lopsided matchups where Elo differences are large.
Such differences are particularly informative when predicting spread outcomes away from the median expectation value, e.g.\ when predicting a blowout. 

\section{Orthogonal point combinations}

\begin{figure}
  \includegraphics{ratings}
  \caption{Predicted mean points scored and mean points allowed against a league average opponent calculated for each team in week 12 of the 2017 NFL season using the margin-dependent Elo model.}
  \label{fig:ratings}
\end{figure}

In addition to the point spread $s = p_s - p_a$, it's also possible to predict the distribution of \emph{total} points scored $t = p_s + p_a$.
The point total and point spread values represent symmetric and asymmetric components of the two teams' point distributions and form an orthogonal basis for the game score. 

Point total ratings can be constructed in an analogous fashion to the aforementioned point spread ratings by using an Elo win criteria with the modified form
\begin{equation}
  \label{win_total}
  \text{win}: p_s + p_a - m > 0,
\end{equation}
where $m$ applies a handicap to the point total $t$.
This is equivalent to the margin-dependent spread condition, except that we've flipped the sign of the opponent's points.
In doing so, the spread difference turns into a sum, and a team wins their game if its score exceeds its opponent's \emph{negated} score by a finite margin of victory, i.e.\ if the point total of both teams exceeds a given threshold.

For example, we might choose to flip the sign of all away teams.
We then take the difference between every home team score and every (negative) away team score, equal to both teams' combined point total.
If this difference exceeds a pre-specified point total handicap, we say the home team wins and away team loses or \emph{vice versa}.
Naturally, the procedure is then repeated but with the sign flip applied to all home teams such that the arbitrary win criteria is reflected, i.e.\ with the logic negated.

The procedure consequently splits each team's rating into two mirror copies as before: one for both positive and negative values of the handicap $m$.
Games which rack up a large number of points increase ratings with positive handicap values $m > 0$ and decrease ratings with negative handicap values $m < 0$.
Since model predictions always pair a positive handicap value with a negative handicap value, e.g.\ $\mathcal{R}_\text{team}(m)$ and $\mathcal{R}_\text{opp}(-m)$, such high scoring games \emph{increase} the gap between ratings with positive and negative handicaps, and subsequently increase the probability that the two teams would exceed the specified point total in subsequent matchups.

Once the point spread and point total Elo ratings are determined for two teams, it is possible to predict not just the game's point spread and point total, but also each team's points scored!
We observe that the points scored and points allowed by each team are just orthogonal combinations of the point spread and point total, i.e.\
\begin{align}
  \bar{p}_s &= \tfrac{1}{2}(\bar{s} + \bar{t}),\nonumber \\
  \bar{p}_a &= \tfrac{1}{2}(\bar{s} - \bar{t}),
  \label{points}
\end{align}
where $\bar{s}$ is the average point spread and $\bar{t}$ the average point total.

For example, one interesting application is to use Eqn.~\eqref{points} to predict the points scored and points allowed by every team in a league against a league average opponent.
Scatter plotting each team's points scored and points allowed will then give us an indication of which teams are strong offensively (score many points) and which teams are strong defensively (allow few points).

We demonstrate such a calculation in Fig.~\ref{fig:ratings} where we show the projected points scored and points allowed for each team against a league average opponent in week 12 of the 2017 NFL season.
Note that higher points scored and lower points allowed tend to correlate with stronger offenses and defenses respectively, but the correspondence is not one-to-one as defense may score points and offenses may give up points.

\begin{figure}[b]
  \includegraphics{home_field}
  \caption{Ratio of probabilities of observing a home field biased point spread over an unbiased point spread as a function of point spread. The blue line denotes calculations derived from NFL game scores and the orange line model predictions from margin-dependent Elo ratings. Model predictions are drawn from samples of the model's predicted point spread distribution for each game. The effect of no home field advantage is indicated by a gray dashed line for reference.}
  \label{fig:home_field}
\end{figure}

\begin{figure*}
  \includegraphics{team_history}
  \caption{Handicapped NFL team Elo ratings 2009--present. Colored lines denote different handicaps. Dark blue denotes a handicap of 0 points and dark red a handicap of 40 points. Intermediate colors are constant handicap increments of 5 points. Ratings for Rams and Chargers persist through relocation. Not shown: advantaged ratings which mirror handicapped ratings.}
\end{figure*}


\section{Applying the model to the NFL}

\begin{figure}
  \includegraphics{mean_abs_error}
  \caption{Mean absolute error of NFL point spread residuals calculated for years 1979--2017. Blue points are Vegas betting lines from Ref.~\ref{?}, and orange points are calculations from the margin-dependent Elo model. The horizontal dashed line is the mean absolute error of a ``dumb'' model which predicts fixed spread of zero for each game.}
  \label{fig:mean_abs_error}
\end{figure}

\begin{figure*}
  \includegraphics{predict}
  \caption{NFL score predictions determined from the margin-dependent Elo model for the second week of the 2017 season. Orange dashes are the prediction medians, boxes are the 25--75\% inner-quartile range, and whiskers cover 90\% of the distribution tails. Home field advantage was accounted for by handicapping the away team 60 Elo points.}
\end{figure*}

In this section we apply the aforementioned margin-dependent Elo rating system to the National Football League (NFL) using game data from 2009--present.
All game data was acquired using the open source \texttt{nfldb} Python package written by Andrew Gallant.
The purpose of this section is to demonstrate the efficacy of the proposed model in a real world scenario and to give examples of specific model calculations which are not possible using existing Elo methods.
We emphasize that the proposed model cannot be used to ``beat Vegas'', at least in the usual sense, as we do not account for weather, injuries or personnel changes which contribute significantly to NFL betting lines.
Nevertheless, the point spread and point total distributions calculated from the margin-dependent Elo model predict median values surprisingly close to opening betting lines and contain a wealth of novel information.

\subsection{Initializing the Elo ratings}

In the original Elo model, it is customary to initialize ratings using a single standard starting value. 
Initializing the margin-dependent Elo model is slightly more nuanced as we require a starting Elo rating for each value of the point spread (or point total), and these values are all interrelated.

The correct starting criteria for the original Elo model requires that each team start with an equal probability to win.
Similarly, the correct starting criteria for the margin-dependent Elo model is to require that each team start by sampling point spreads and point totals from a minimum bias distribution.

We enforce this starting criteria by calculating the minimum bias distribution of point spreads and point totals from historical NFL scores and using this distribution to solve for the starting Elo ratings which are required to sample from the observed distribution.
For example, the formula for initializing the point spread Elo ratings can be determined by inverting Eqn.~\eqref{win_prob_hcap} and is given by
\begin{equation}
  \mathcal{R}_\text{init}(\pm n) = \mathcal{R}_0 \mp \frac{1}{2} \log\left(1/P - 1 \right),
\end{equation}
where $\mathcal{R}_0 = 1500$ is the customary starting value in the original Elo model (handicap of zero) and ${P=\mathrm{Prob}(s > n)}$ is the probability that the minimum bias point spread $s$ is greater than $n$ points.
The proper starting Elo ratings for the point total can be furnished in an analogous fashion.

\subsection{Regressing towards the mean}

Elo ratings are updated using posterior information which registers the moment a game is completed.
Clearly, current Elo ratings cannot reliably predict team performance far into the future, say 10 years from now.
In fact, such predictions would likely yield little or no information at all.
The information in the Elo ratings begins to decay and regress towards the mean the moment they are updated after a game.
This effect exists between subsequent games in the regular season, but it is largely negligible compared the much larger lapse in time between individual seasons.
To better account for hard to quantify changes that occur during the offseason, we follow the method used by FiveThirtyEight and regress each team rating toward its mean handicap value by a fixed percentage each offseason.
We find that regressing each rating to 64\% of its starting value each season for point spreads and 70\% for point totals leads to the best description of game outcomes.

\subsection{Home field advantage}

Team's generally perform better at home and worse on the road.
Football analysts often quote a ${\sim}\,3$ point advantage for the home team relative to what the spread would otherwise be on a neutral field. 
This tacitly assumes that home field advantage applies a translational shift to the game's spread distribution, when in reality, a shift is just one of a number of reasonable transformations.
For instance, a skewness transformation seems equally plausible at face value.

The margin-dependent Elo model admits an exceptionally simple and intuitive method to incorporate home field advantage which does not assert a specific functional form.
One can think of home field advantage as a temporary boost to a team's Elo rating, i.e.\ teams with home field advantage play like slightly better versions of themselves.  
Home field advantage can thus be incorporated by increasing the Elo gap between home teams and away teams by a constant offset $\mathcal{R}_\text{hfa}$ which we assume to be equal at every value of the handicap, i.e.\
\begin{equation}
  \Delta \mathcal{R} = \mathcal{R}_\text{home} - \mathcal{R}_\text{away} + \mathcal{R}_\text{hfa}.
\end{equation}
This means, for instance, that losses which occur on the road are penalized less heavily than losses which occur at home since they are modeled as if the opponent had a slightly higher Elo rating.
Additionally, when predicting the outcome of future matches, one must also add $\mathcal{R}_\text{hfa}$ to the matchup's Elo difference $\Delta \mathcal{R}$ in favor of the home team to account for their advantage.

Remarkably, we find that this simple ansatz can reproduce the actual effect of home field advantage, not just on average, but also as a function of point spread.
A good way to examine the effect of home field advantage is to look at the relative change in the distribution of point spreads when I always define the point spread relative to the home team, versus when I define the point spread relative to either team with equal probability.
This ratio of biased and unbiased distributions, plotted in Fig.~\ref{fig:home_field}, clearly shows the effect of home field advantage on the point spread distribution as a function of the point spread, and illustrates that the aforementioned ansatz captures the salient features of the observed transformation up to statistical fluctuations.

\subsection{Validation}

The principle quantity underlying the present application of the margin-dependent Elo ratings to the NFL is a time series of Elo ratings for each team in the NFL for each value of the handicap.
As described previously in the text, the algorithm can be slightly modified to calculate either point spreads and point totals.

We test the margin-dependent Elo model by back testing on historical NFL game data.
The model predicts a distribution of point spread and point totals for each game so it is important to distinguish between the model's accuracy and its precision. 
For example, a model that predicts that all NFL point totals will be less than a thousand is precise but inaccurate.

A commonly used measure to test the accuracy of NFL betting models is the mean absolute error, defined as the arithmetic mean of the absolute value of model residuals.
We compare the mean absolute error of the margin-dependent Elo model against Vegas lines  for years {1978--2017}.
Unfortunately, the NFL stats database used to calculate the present margin-dependent Elo ratings only extends back as far as 2009, and the Vegas lines used in Fig.~\ref{fig:mean_abs_error} only extends through 2013.

\section{Concluding remarks}

In this work, we formulate a simple extension to the original Elo model which generalizes the algorithm from binary win/loss predictions to full probability distributions of point spread and point total outcomes.
The generalized model allows us to predict the median and mean scores, as well as any other statistical quantity which can be derived from the underlying point distributions, for instance the interquartile ranges. 

We have applied the model to the NFL for the years 2009--present and shown how the algorithm can be used to generate predictions for each game.
Moreover, we explain how the point spread and point total predictions can be combined to predict the points each team would score and allow against a league average opponent. 

The model is back tested to assess the distribution of model residuals.
Our findings indicate the probabilistic predictions are highly precise with accuracy that are comparable, albeit slightly worse, than Vegas betting lines.
Naturally, the model's accuracy would benefit from additional factors such as personnel changes, weather and extraneous circumstances which are already accounted for in betting lines.

We emphasize that the present algorithm should readily generalize to any point based competitive game.
For example, the model would be ideally suited for the National Basketball Association (NBA) due to its high scoring statistics and frequent game play. 
We leave these applications to future studies.

\medskip

All software used in this work is open source.
The \texttt{melo} Python package is publicly available at \mbox{\url{github.com/morelandjs/melo}}.
Several third-party software packages were also invaluable: the \texttt{nfldb} Python package written by Andrew Gallant \cite{nfldb}, the \texttt{scipy} library for scientific computing \cite{scipy}, and the \texttt{scikit-optimize} package for optimizing noisy and expensive functions \cite{skopt}. 

\bibliography{marginelo}

\end{document}
